<div class="container mt-4">
  <div class="card shadow-sm bg-white border-0">
    <div
      class="card-header pb-0 d-flex justify-content-between align-items-center bg-white"
    >
      <h5 class="mb-0 text-dark">
        <i class="fa-solid fa-user-plus me-2 text-primary"></i>
        {{ esEdicion ? 'Editar Usuario' : 'Registro de Usuario' }}
      </h5>
      <a routerLink="/Usuarios" class="btn btn-secondary btn-sm">
        <i class="fas fa-arrow-left me-1"></i> Volver
      </a>
    </div>

    <app-loading-component *ngIf="loading"></app-loading-component>

    <div class="card-body">
      <form [formGroup]="registroUsuario" (ngSubmit)="createUsuario()">
        <!-- Código Institucional -->
        <div class="mb-3">
          <label for="codigoInstitucional" class="form-label">Código Institucional</label>
          <input
            id="codigoInstitucional"
            type="text"
            class="form-control"
            formControlName="codigoInstitucional"
            placeholder="Ej. 20231234"
            [readonly]="esEdicion"
          />
          <div
            *ngIf="showError('codigoInstitucional')"
            class="invalid-feedback d-block"
          >
            {{ getErrorMessage('codigoInstitucional') }}
          </div>
        </div>

        <!-- Sede (Dropdown con 5 distritos) -->
        <div class="mb-3">
          <label for="sede" class="form-label">Sede</label>
          <select id="sede" class="form-control" formControlName="sede">
            <option [ngValue]="null">Seleccione una sede</option>
            <option value="San Juan de Lurigancho">San Juan de Lurigancho</option>
            <option value="Miraflores">Miraflores</option>
            <option value="Los Olivos">Los Olivos</option>
            <option value="San Miguel">San Miguel</option>
            <option value="Villa El Salvador">Villa El Salvador</option>
          </select>
          <div *ngIf="showError('sede')" class="invalid-feedback d-block">
            {{ getErrorMessage('sede') }}
          </div>
        </div>

        <!-- Nombre -->
        <div class="mb-3">
          <label for="nombre" class="form-label">Nombre</label>
          <input
            id="nombre"
            type="text"
            class="form-control"
            formControlName="nombre"
            placeholder="Ej. Juan"
          />
          <div *ngIf="showError('nombre')" class="invalid-feedback d-block">
            {{ getErrorMessage('nombre') }}
          </div>
        </div>

        <!-- Apellido -->
        <div class="mb-3">
          <label for="apellido" class="form-label">Apellido</label>
          <input
            id="apellido"
            type="text"
            class="form-control"
            formControlName="apellido"
            placeholder="Ej. Pérez"
          />
          <div *ngIf="showError('apellido')" class="invalid-feedback d-block">
            {{ getErrorMessage('apellido') }}
          </div>
        </div>

        <!-- Correo Institucional -->
        <div class="mb-3">
          <label for="correoInstitucional" class="form-label">Correo Institucional</label>
          <input
            id="correoInstitucional"
            type="email"
            class="form-control"
            formControlName="correoInstitucional"
            placeholder="Ej. juan.perez@instituto.edu.pe"
          />
          <div
            *ngIf="showError('correoInstitucional')"
            class="invalid-feedback d-block"
          >
            {{ getErrorMessage('correoInstitucional') }}
          </div>
        </div>
<!-- Contraseña -->
<div class="mb-3" *ngIf="!esEdicion">
  <label for="contrasena" class="form-label">Contraseña</label>
  <input
    id="contrasena"
    type="password"
    class="form-control"
    formControlName="contrasena"
    placeholder="Ingrese contraseña"
  />
  <div *ngIf="showError('contrasena')" class="invalid-feedback d-block">
    {{ getErrorMessage('contrasena') }}
  </div>
</div>

        <!-- Tipo -->
        <div class="mb-3">
          <label for="tipo" class="form-label">Tipo de Usuario</label>
          <ng-select
            [items]="tipos"
            bindLabel="label"
            bindValue="value"
            formControlName="tipo"
            placeholder="Seleccione el tipo"
            class="custom-ng-select"
          ></ng-select>
          <div *ngIf="showError('tipo')" class="invalid-feedback d-block">
            {{ getErrorMessage('tipo') }}
          </div>
        </div>

        <!-- Estado -->
        <div class="form-check form-switch mb-3">
          <input
            class="form-check-input"
            type="checkbox"
            id="estado"
            formControlName="estado"
          />
          <label class="form-check-label" for="estado">Activo</label>
        </div>

        <!-- Botón -->
        <div class="text-end">
          <button type="submit" class="btn btn-primary">
            <i class="fas fa-save me-1"></i>
            {{ esEdicion ? 'Actualizar Usuario' : 'Guardar Usuario' }}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
